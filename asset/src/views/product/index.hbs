<link rel="stylesheet" href="/css/product.css">

<div class="container bg-white">
    <div class="row">
        <div class="col-5">
            <div class="product-imgs">
                <img src="{{product.Images}}" alt="">
            </div>
        </div>

        <div class="col-7">
            <div class="product-info" prd="{{product.ProductId}}" usrid="{{currentUser.UserId}}">
                <h3 class="product-infor_title mt-4 me-3">{{product.Productname}}</h3>
                <p class="product-infor_price">{{product.Price}}đ</p>

                <div class="row mb-4 align-items-center">
                    <div class="col-auto">Số lượng:</div>
                    <div class="col-auto ps-0 pe-0">
                        <div id="divQuantity" class="input-group">
                            <button id="quantityMinus" class="btn btn-primary" type="button">−</button>
                            <input id="quantityInput" type="number" min="1" max="100" class="form-control" value="1">
                            <button id="quantityPlus" class="btn btn-primary" type="button">+</button>
                        </div>
                    </div>
                    <div class="col">{{product.Quantity}} sản phẩm có sẵn</div>
                </div>
            </div>

            <div class="product-infor_btn">
                <button class="btn border border-primary">
                    <i class="fa-regular fa-cart-plus"></i>
                    Thêm vào giỏ hàng</button>
                <button class="btn text-bg-primary border border-primary">Mua Ngay</button>
            </div>

        </div>
    </div>
</div>

<div class="container mt-3">
    <div class="row">
        <div class="col-8 bg-white position-relative">
            <div id="product-description" class="row">
                {{{product.Description}}}
            </div>
            <div class="divreadmore">
                <button id="btn-readmore" class="btn btn-light">Xem thêm▼</button>
            </div>
        </div>
        <div class="col-auto">...</div>
    </div>
</div>

<div class="container bg-white mt-4">
    <h4 class="rating-title">Đánh giá sản phẩm</h4>
    <hr>
    <div class="row">
        <!-- Giao diện đánh giá trung bình -->
        <div class="col evalution-statisc">
            <p>Đánh giá trung bình</p>
            <span id="averageRating">0/5</span>
            <div class="rating size-m">
                <i class="fas fa-star" data-star="1"></i>
                <i class="fas fa-star" data-star="2"></i>
                <i class="fas fa-star" data-star="3"></i>
                <i class="fas fa-star" data-star="4"></i>
                <i class="fas fa-star" data-star="5"></i>
            </div>
            <p id="totalReviews">0 đánh giá</p>
        </div>
        {{!-- giao diện thanh đánh giá --}}
        <div class="col">
            <div class="progress-statisc">
                <div class="rating-progress">
                    <span class=" pe-1">5</span>
                    <i class="fas fa-star pe-1 active"></i>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="25"
                            aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <span class="total-rating ps-2">{{rating.star5}}</span>
                </div>
                <div class="rating-progress">
                    <span class=" pe-1">4</span>
                    <i class="fas fa-star pe-1 active"></i>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="25"
                            aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <span class="total-rating ps-2">{{rating.star4}}</span>
                </div>
                <div class="rating-progress">
                    <span class=" pe-1">3</span>
                    <i class="fas fa-star pe-1 active"></i>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="25"
                            aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <span class="total-rating ps-2">{{rating.star3}}</span>
                </div>
                <div class="rating-progress">
                    <span class=" pe-1">2</span>
                    <i class="fas fa-star pe-1 active"></i>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="25"
                            aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <span class="total-rating ps-2">{{rating.star2}}</span>
                </div>
                <div class="rating-progress">
                    <span class=" pe-1">1</span>
                    <i class="fas fa-star pe-1 active"></i>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="25"
                            aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <span class="total-rating ps-2">{{rating.star1}}</span>
                </div>
            </div>
        </div>

        <div class="col">
            <div class="d-flex flex-column align-items-center justify-content-center h-100">
                <p>Bạn đã dùng sản phẩm này?</p>
                <!-- Nút để mở modal -->
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modal-rating">GỬI ĐÁNH
                    GIÁ</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="modal-rating">
    <div class="modal-dialog">
        <div class="modal-content" style="width: 550px;">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title">Đánh Giá Sản Phẩm</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <!-- Modal Body -->
            <div class="modal-body">
                <!-- Form nhập liệu -->
                <form>
                    <div class="row">
                        <div class="d-flex justify-content-center">
                            <img src="{{product.Images}}" class="pdr-img">
                        </div>
                        <h6 class="pdr-Productname">{{product.Productname}}</h6>
                    </div>

                    <div class="d-flex flex-column align-items-center justify-content-center">
                        <div class="rating" id="rating">
                            <i class="fas fa-star" data-star="1"></i>
                            <i class="fas fa-star" data-star="2"></i>
                            <i class="fas fa-star" data-star="3"></i>
                            <i class="fas fa-star" data-star="4"></i>
                            <i class="fas fa-star" data-star="5"></i>
                        </div>
                        <div id="ratingText"></div>
                    </div>

                    <div class="row mb-2">
                        <div class="col-2">
                            <div class="form-check">
                                <input class="form-check-input pointer" type="radio" name="gioiTinh" id="prd-male"
                                    value="Nam" checked="true">
                                <label class="form-check-label pointer" for="prd-male">Anh</label>
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-check">
                                <input class="form-check-input pointer" type="radio" name="gioiTinh" id="pdr-female"
                                    value="Nữ">
                                <label class="form-check-label pointer" for="pdr-female">Chị</label>
                            </div>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col">
                            <input id="pdr-username" type="text" class="form-control" placeholder="Nhập họ và tên"
                                value="{{currentUser.DisplayName}}">
                        </div>
                        <div class="col">
                            <input id="pdr-email" type="email" class="form-control" placeholder="Nhập email"
                                value="{{currentUser.Email}}">
                        </div>
                    </div>

                    <div class="mb-2">
                        <textarea class="form-control" id="pdr-description"
                            placeholder="Hãy chia sẽ cảm nhận về sản phẩm" rows="4"></textarea>
                    </div>
                </form>
            </div>

            <!-- Modal Footer -->
            <div class="modal-footer justify-content-center">
                <button id="btn-pdr_save" type="button" class="btn btn-primary">HOÀN TẤT</button>
            </div>

        </div>
    </div>
</div>

<div class="container mt-3 mb-3">
    <div class="rating-filter d-flex align-items-center">
        <p class="me-2">Lọc sản phẩm theo: </p>
        <button class="btn btn-outline-secondary me-2">5 sao</button>
        <button class="btn btn-outline-secondary me-2">4 sao</button>
        <button class="btn btn-outline-secondary me-2">3 sao</button>
        <button class="btn btn-outline-secondary me-2">2 sao</button>
        <button class="btn btn-outline-secondary me-2">1 sao</button>
    </div>
</div>

<div id="templateReviewsContent" class="userRating container bg-white">
    {{#if productReviews}}
    {{#each productReviews}}
    <div class="row mb-3">
        <div class="col-auto">
            <img src="{{this.Avatar}}" alt="">
        </div>
        <div class="col">
            <p class="userRating-name">{{this.UserName}}</p>
            <div class="rating size-m" data-rating="{{this.Rating}}">
                <i class="fas fa-star" pdr-star="1"></i>
                <i class="fas fa-star" pdr-star="2"></i>
                <i class="fas fa-star" pdr-star="3"></i>
                <i class="fas fa-star" pdr-star="4"></i>
                <i class="fas fa-star" pdr-star="5"></i>
            </div>
            <p class="userRating-comment text-secondary">{{this.Description}}</p>
            <span class="text-secondary">{{this.AtCreate}}</span>
        </div>
    </div>
    {{/each}}
    {{else}}
    <div>
        <h5 class=" text-center">
            chưa có đánh giá nào cho sản phẩm này, bạn có muốn trở thành người đánh giá đầu tiên không?
        </h5>
    </div>
    {{/if}}
    {{#if productReviews}}
    <div class="d-flex justify-content-center">
        <button id="btn-pdr_prev" type="button" class="btn btn-primary me-2 disabled" onclick="btnPdRevPrev()">
            <i class="fa-solid fa-chevron-left"></i>
        </button>

        <button id="btn-pdr_next" type="button" class="btn btn-primary ms-2" onclick="btnPdRevNext()">
            <i class="fa-solid fa-chevron-right"></i>
        </button>
    </div>
    {{/if}}
</div>

<script type="text/x-handlebars-template" id="template-productReviews">
%#if productReviews%
    %#each productReviews%
    <div class="row mb-3">
        <div class="col-auto">
            <img src="%this.Avatar%" alt="">
        </div>
        <div class="col">
            <p class="userRating-name">%this.UserName%</p>
            <div class="rating size-m" data-rating="%this.Rating%">
                <i class="fas fa-star" pdr-star="1"></i>
                <i class="fas fa-star" pdr-star="2"></i>
                <i class="fas fa-star" pdr-star="3"></i>
                <i class="fas fa-star" pdr-star="4"></i>
                <i class="fas fa-star" pdr-star="5"></i>
            </div>
            <p class="userRating-comment text-secondary">%this.Description%</p>
            <span class="text-secondary">%this.AtCreate%</span>
        </div>
    </div>
    %/each%
    %/if%

    <div class="d-flex justify-content-center">
        <button id="btn-pdr_prev" type="button" class="btn btn-primary me-2" onclick="btnPdRevPrev()">
            <i class="fa-solid fa-chevron-left"></i>
        </button>

        <button id="btn-pdr_next" type="button" class="btn btn-primary ms-2" onclick="btnPdRevNext()">
            <i class="fa-solid fa-chevron-right"></i>
        </button>
    </div>
</script>

<script>
    window.addEventListener('DOMContentLoaded', function () {

    });
</script>
{{!--
<script src="../../configs/globalVariables.js"></script> --}}
<script src="/js/product.js"></script>